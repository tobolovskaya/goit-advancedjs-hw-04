{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '45156920-6e611072a4f9c22ae400d324b';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport const fetchImages = async (query, page = 1, perPage = 15) => {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    page: page,\n    per_page: perPage,\n  };\n\n  try {\n    const response = await axios.get(BASE_URL, { params });\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n};","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n});\n\nconst loadImage = src => {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.src = src;\n    img.onload = () => resolve(src);\n    img.onerror = error => reject(error);\n  });\n};\n\nexport const renderImages = async (images, reset = false) => {\n  if (reset) {\n    gallery.innerHTML = '';\n  }\n\n  if (images.length === 0) {\n    gallery.innerHTML = '';\n    lightbox.refresh();\n    return;\n  }\n\n  const imagePromises = images.map(image => loadImage(image.webformatURL));\n  await Promise.all(imagePromises);\n\n  const fragment = document.createDocumentFragment();\n\n  images.forEach(image => {\n    const a = document.createElement('a');\n    a.href = image.largeImageURL;\n    a.classList.add('gallery-item');\n\n    const img = document.createElement('img');\n    img.src = image.webformatURL;\n    img.alt = image.tags;\n\n    const infoDiv = document.createElement('div');\n    infoDiv.classList.add('info');\n\n    const likesDiv = document.createElement('div');\n    likesDiv.innerHTML = `<p>Likes</p><p>${image.likes}</p>`;\n\n    const viewsDiv = document.createElement('div');\n    viewsDiv.innerHTML = `<p>Views</p><p>${image.views}</p>`;\n\n    const commentsDiv = document.createElement('div');\n    commentsDiv.innerHTML = `<p>Comments</p><p>${image.comments}</p>`;\n\n    const downloadsDiv = document.createElement('div');\n    downloadsDiv.innerHTML = `<p>Downloads</p><p>${image.downloads}</p>`;\n\n    infoDiv.append(likesDiv, viewsDiv, commentsDiv, downloadsDiv);\n    a.append(img, infoDiv);\n    fragment.appendChild(a);\n  });\n\n  gallery.appendChild(fragment);\n  lightbox.refresh();\n};\n\nexport const notificationsConfig = {\n  position: 'topRight',\n  messageColor: 'white',\n  iconColor: 'white',\n};\n\nexport const showErrorNotification = message => {\n  iziToast.error({\n    message: message,\n    color: '#EF4040',\n    ...notificationsConfig,\n  });\n};\n\nexport const showNotification = message => {\n  iziToast.info({\n    message: message,\n    color: '#0099FF',\n    ...notificationsConfig,\n  });\n};\n","import { fetchImages } from './js/pixabay-api';\r\nimport { renderImages, showNotification } from './js/render-functions';\r\n\r\nconst form = document.querySelector('.search-form');\r\nconst input = document.querySelector('.search-form input[name=\"search\"]');\r\nconst gallery = document.querySelector('.gallery');\r\nconst loader = document.querySelector('.loader');\r\nconst loadMoreBtn = document.querySelector('.load-more');\r\n\r\nlet currentPage = 1;\r\nlet currentQuery = '';\r\nlet totalImagesLoaded = 0;\r\n\r\nconst handleSubmitForm = async event => {\r\n  event.preventDefault();\r\n  const query = input.value.trim();\r\n\r\n  if (!query) {\r\n    showNotification('Please enter a search query.');\r\n    return;\r\n  }\r\n\r\n  loadMoreBtn.style.display = 'none';\r\n  loader.style.display = 'none';\r\n  currentPage = 1;\r\n  totalImagesLoaded = 0;\r\n  currentQuery = query;\r\n\r\n  try {\r\n    loader.style.display = 'flex';\r\n    const data = await fetchImages(query, currentPage);\r\n    totalImagesLoaded = data.hits.length;\r\n\r\n    if (data.hits.length === 0) {\r\n      showNotification(\r\n        'Sorry, there are no images matching your search query. Please try again!'\r\n      );\r\n      return;\r\n    }\r\n\r\n    await renderImages(data.hits, true);\r\n\r\n    if (totalImagesLoaded < data.totalHits) {\r\n      loadMoreBtn.style.display = 'block';\r\n    } else {\r\n      showNotification(\r\n        \"We're sorry, but you've reached the end of search results.\"\r\n      );\r\n    }\r\n  } catch (error) {\r\n    showNotification(\r\n      'An error occurred while fetching images. Please try again later.'\r\n    );\r\n  } finally {\r\n    loader.style.display = 'none';\r\n    form.reset();\r\n  }\r\n};\r\n\r\nconst handleLoadMore = async () => {\r\n  currentPage += 1;\r\n\r\n  loadMoreBtn.style.display = 'none';\r\n  loader.style.display = 'flex';\r\n\r\n  try {\r\n    const data = await fetchImages(currentQuery, currentPage);\r\n    totalImagesLoaded += data.hits.length;\r\n\r\n    await renderImages(data.hits);\r\n\r\n    const { height: cardHeight } = document\r\n      .querySelector('.gallery-item')\r\n      .getBoundingClientRect();\r\n    window.scrollBy({\r\n      top: cardHeight * 2 + 48,\r\n      behavior: 'smooth',\r\n    });\r\n\r\n    if (totalImagesLoaded >= data.totalHits) {\r\n      showNotification(\r\n        \"We're sorry, but you've reached the end of search results.\"\r\n      );\r\n    } else {\r\n      loadMoreBtn.style.display = 'block';\r\n    }\r\n  } catch (error) {\r\n    showNotification(\r\n      'An error occurred while fetching more images. Please try again later.'\r\n    );\r\n  } finally {\r\n    loader.style.display = 'none';\r\n  }\r\n};\r\n\r\nform.addEventListener('submit', handleSubmitForm);\r\nloadMoreBtn.addEventListener('click', handleLoadMore);\r\n"],"names":["API_KEY","BASE_URL","fetchImages","query","page","perPage","params","axios","error","gallery","lightbox","SimpleLightbox","loadImage","src","resolve","reject","img","renderImages","images","reset","imagePromises","image","fragment","a","infoDiv","likesDiv","viewsDiv","commentsDiv","downloadsDiv","notificationsConfig","showNotification","message","iziToast","form","input","loader","loadMoreBtn","currentPage","currentQuery","totalImagesLoaded","handleSubmitForm","event","data","handleLoadMore","cardHeight"],"mappings":"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"}